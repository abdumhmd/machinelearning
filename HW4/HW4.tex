\documentclass[11pt]{article}
\usepackage{color}
\usepackage{graphicx}
\usepackage{amsmath,amsthm,amssymb,multirow,paralist}
\usepackage[margin=0.8in]{geometry}
\usepackage[]{algorithm2e}
\usepackage{hyperref}
\usepackage{tikz,forest}
\usetikzlibrary{arrows.meta}

\providecommand{\abs}[1]{\left\vert#1\right\vert}
\providecommand{\norm}[1]{\left\Vert#1\right\Vert}

\begin{document}

\begin{center}
    {\Large \textbf{COM S 573: Machine Learning}\\Homework \#4}\\

    \linethickness{1mm}\line(1,0){498}

    \begin{enumerate}
        \item Please put required code files and report into a
              compressed file ``HW\#\_FirstName\_LastName.zip''
        \item Unlimited number of submissions are
              allowed on Canvas and the latest one will be graded.
        \item {\color{red} No later submission is accepted.}
        \item Please read and follow submission instructions. No exception
              will be made to accommodate incorrectly submitted files/reports.
        \item All students are required to typeset their reports using
              latex. Overleaf
              (\url{https://www.overleaf.com/learn/latex/Tutorials}) can be a
              good start.
    \end{enumerate}

    \linethickness{1mm}\line(1,0){498}

\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{enumerate}

    \item (30 points) \textbf{Hierarchical clustering}

    Use the similarity matrix in Table~\ref{tb:exp1} to perform
    (1) single (MIN) and (2) complete (MAX) link hierarchical
    clustering. Show each step with dendrogram and the
    corresponding similarity matrix update. The dendrogram should
    clearly show the order in which the points are merged.
    Suppose we choose to use 3 clusters, Show the cut in each
    final dendrogram.

    \begin{table}[ht]\label{tb:exp1}
        \centering
        \caption{Similarity matrix.}

        \begin{tabular}{ l| c | c | c | c | c}\hline
                   & \textbf{p1} & \textbf{p2} & \textbf{p3} & \textbf{p4} & \textbf{p5} \\ \hline
            \bf p1 & 1.00        & 0.10        & 0.41        & 0.55        & 0.35        \\
            \bf p2 & 0.10        & 1.00        & 0.64        & 0.47        & 0.98        \\
            \bf p3 & 0.41        & 0.64        & 1.00        & 0.44        & 0.85        \\
            \bf p4 & 0.55        & 0.47        & 0.44        & 1.00        & 0.76        \\
            \bf p5 & 0.35        & 0.98        & 0.85        & 0.76        & 1.00        \\
            \hline
        \end{tabular}
        % \vspace{-5pt}
    \end{table}

    \item (20 points) \textbf{K-Medians Clustering}
    
    The K-means algorithm can be summarized as below:
    \begin{enumerate}
        \item Select K points as the initial centroids.
        \item \textbf{repeat}
        \item \;\;\;\; Form K clusters by assigning all points to the closest centroid.
        \item \;\;\;\; Recompute the centroid of each cluster.
        \item \textbf{until} The centroids don't change.
    \end{enumerate}

    K-medians clustering is a variation of k-means clustering
    where it calculates the median for each cluster to determine
    its center instead of using the mean. Also, K-medians makes
    use of the Manhattan distance for points assignment.
    
    \begin{enumerate}
        \item (8 points) Please show the algorithm of K-medians
        in the above format.


        \item (6 points) Please explain how you will compute the median
        for each cluster.


        \item (6 points) Does K-medians help to avoid the outlier
        problem? Justify your answer.

    \end{enumerate}
    

    \item (20 points) \textbf{ Principal Components Analysis}
    
    Given three data points: $(-1, -1), (0,0), (1,1)$.

    \begin{enumerate}
        \item (10 points) Show the first Principal Component
        (actual vector) without using Eigendecomposition. Justify
        your answer.

        
        \item (10 points) If use the $1^{st}$ principle component
        to transform the data into 1-d space. What are the new
        data?


    \end{enumerate}

    \item (30 points) \textbf{Principal Component Analysis:}
    
    In this homework, you will apply the principal component
    analysis to a collection of handwritten digit images from the
    USPS dataset. The USPS dataset is in the ``data'' folder:
    USPS.mat. The starting code is in the ``code'' folder. The
    whole data has already been loaded into the matrix $A$. The
    matrix $A$ has shape $3000\times 256$ and contains all the
    images. Each row in $A$ corresponds to a handwritten digit
    image (between 0 and 9) with size $16\times 16$. You are
    expected to implement your solution based on the given codes.
    The only file you need to modify is the ``solution.py'' file.
    You can test your solution by running the ``main.py'' file.
    
    \begin{enumerate}
    \item (15 points) In PCA, we obtain a projection matrix or
    reduce matrix $\boldsymbol U \in \mathbb{R}^{d\times p}$.
    Based on $\boldsymbol U$, we project the original centered
    data $\boldsymbol{\bar{X}} \in \mathbb{R}^{d\times n}$ into
    reduced data $\boldsymbol{Z} \in \mathbb{R}^{p\times n}$.
    Complete the \emph{\textbf{\_do\_pca()}} method. You only
    need to center the data instead of applying mean
    normalization. Your code will be tested on $p$ = 10, 50, 100,
    200, total four different numbers of the principal
    components.
    
    \item (5 points) Based on the projection matrix $\boldsymbol
    U$ and reduce data $\boldsymbol{Z}$, we can reconstruct the
    original data  $\boldsymbol{{X}'}$ by $\boldsymbol{U}
    \boldsymbol{Z}$ and adding back the original means. Here you
    need to  Complete the \emph{\textbf{reconstruction()}} method
    to reconstruct the reduced data.
    
    \item (5 points) Based on the reconstructed data
    $\boldsymbol{\bar{X}'}$, we can compute measure the
    reconstruction error by $||\boldsymbol X -
    \boldsymbol{{X}'}||^2_F$. Complete the
    \emph{\textbf{reconstruct\_error()}} function to measuring
    the reconstruction error.
    
    \item (5 points) Run ``main.py'' to see the reconstruction
    results and summarize your observations from the results into
    a short report. When you run the ``main.py'' file, a subset
    (the first two) of the reconstructed images based on p = 10,
    50, 100, 200 principal components will be automatically saved
    on the ``code'' folder. Please attach these images into your
    report also.
    \end{enumerate}
    
    
    \textbf{Note:}You are NOT supposed to use existing PCA libraries; instead, you should write your own PCA. Please read the ``Readme.txt'' file carefully before you start this assignment.

\end{enumerate}

\end{document}
